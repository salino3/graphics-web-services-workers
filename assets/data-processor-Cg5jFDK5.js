(function(){"use strict";self.onmessage=async t=>{if(t.data.type==="loadData"){const c=t.data.payload;try{console.log(`Worker: Starting to fetch data from ${c}`);const e=await fetch(c);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const a=await e.json();console.log(`Worker: Fetched ${a.length} records.`);const s={},n=[],l=[];a.forEach(o=>{const r=o.countryName?o.countryName.charAt(0).toUpperCase():"Other";s[r]||(s[r]=0),s[r]+=o.population});for(const o in s)n.push(o),l.push(s[o]);console.log("Worker: Data processed. Sending results back."),self.postMessage({type:"dataReady",labels:n,values:l,originalRecordCount:a.length})}catch(e){console.error("Worker: Error processing data:",e),self.postMessage({type:"error",message:e.message})}}}})();
